<apex:page controller="cwbtool.ImpactAnalysisCtroller" action="{!init}" title="ImpactAnalysisSummary"  renderAs="pdf" showHeader="false" sidebar="false" standardStylesheets="false" applyBodyTag="false" applyHtmlTag="false">
    <head>
        <style>
            @page{
                size:landscape;
                margin: 5mm;
                margin-top:1cm;
                /*@top-right{
                    content: "{!todaysDate}";
                    font-size: x-small;
                }*/
                @bottom-left{
                    content:  "Generated By: {!$User.FirstName}  {!$User.LastName} {!todaysDate}";
                    font-size: small;
                }
                /*
                @bottom-center{
                    content:  "Page " counter(page) " of " counter(pages)
                }
                @bottom-right{
                    content:  "{!Day(Today())}" '/' "{!Month(Today())}" '/' "{!Year(Today())}"
                }
                */
            }
            .cwbTable{
              text-transform: capitalize;
            }
        </style>
    </head>
    <apex:stylesheet value="{!URLFOR($Resource.cwbtool__ImpactAnalysisPDFStyle2,'style.css')}"/>
    <div class="imageDiv">
        <img class="logoImage" src="{!URLFOR($Resource.ImpactAnalysisPDFStyle, 'ImpactAnalysisPDFStyle/logo.png')}"/>
    </div>
    <br/><br/><br/><br/>
    <div>
        <table style="border-collapse: collapse;">
            <tr>
                <td class="headerLabel">Object:</td>
                <td style="padding-left: 15px; color: black;">{!objImpactAnalysisModel.strObject}</td>
            </tr>
            <tr>
                <td class="headerLabel">Field:</td>
                <td style="padding-left: 15px; color: black;">{!JSINHTMLENCODE(objImpactAnalysisModel.strSearchtext)}</td>
            </tr>
           <!--  <apex:outputText rendered="{!if(len(value)>2,true,false)}">
                <td class="headerLabel">Value:</td>
                <td style="padding-left: 15px; color: black;">{!if(and(ps.analyzeType == 'User',ps.analyzeField=='Name'),ps.analyzeFieldLabel,ps.analyzeValue)}</td>
            </apex:outputText> -->
        </table>
    </div>
    <br/><br/>
    <div class="headerDiv">Impact Summary</div>
    <br/><br/>
    <table class="cwbTable">
        <tr class="cwbTableHeader">
            <th>Component Type</th>
            <!-- <th>Direct Impact</th>
            <th>Indirect Impact</th> -->
            <th>Total Impact</th>
        </tr>
        <apex:repeat value="{!objImpactAnalysisModel.mapAnalysisDetail}" var="key">
          <apex:variable value="{!objImpactAnalysisModel.mapAnalysisDetail[key]}" var="listdetail" />
            <tr>
                <td class="cwbTableFirstColumn">{!JSINHTMLENCODE(key)}</td>
               <!--  <td>{!sr.directCount}</td>
                <td>{!sr.indirectCount}</td>-->
                <td>{!listdetail.size}</td>
            </tr>
        </apex:repeat>
    </table>
    <br/><br/><br/><br/>
    <div class="headerDiv">Top Impacted Components</div>
    <br/><br/>
    <table class="cwbTable" style="text-align: left;">
        <tr class="cwbTableHeader">
            <th>Component Type</th>
            <th>Component Name</th>
            <th>Folder/Object</th>
           <!--  <th>Created By</th>
            <th>Created Date</th> -->
            <th>last Modified By</th>
            <th>last Modified date</th>
            <!-- <th>Last Modified Date</th> -->
        </tr>
        <apex:repeat value="{!objImpactAnalysisModel.mapAnalysisDetail}" var="key">
          <apex:repeat value="{!objImpactAnalysisModel.mapAnalysisDetail[key]}" var="obj">
            <tr>
                <td>{!JSINHTMLENCODE(key)}</td>
                <td>{!JSINHTMLENCODE(obj.componentname)}</td>
                <td>
                    <!-- <apex:outputText rendered="{!if(or(result.componentType='Report',result.componentType='Dashboard'),true,false)}">{!JSINHTMLENCODE(result.folderLabel)}</apex:outputText> -->
                    <!-- <apex:outputtext rendered="{!if(or(result.componentType='Formula',result.componentType='Page Layout'),true,false)}">{!JSINHTMLENCODE(result.objName)}</apex:outputtext> -->
                    {!JSINHTMLENCODE(obj.folderorobject)}
                </td>
                 <!-- <td>{!JSINHTMLENCODE(obj.createdByName)}</td>
                 <td>
                    <apex:outputText value="{0, date,MM/dd/yy}">
                        <apex:param value="{!obj.createdDate}" />
                    </apex:outputText>
                 </td> -->
                 <td>{!JSINHTMLENCODE(obj.lastModifiedByName)}</td>
                 <td>
                  <apex:outputText value="{0, date,MM/dd/yy}">
                        <apex:param value="{!obj.lastModifiedDate}" />
                    </apex:outputText>
                 </td>
            </tr>
        </apex:repeat>
        </apex:repeat>
     </table>
     
</apex:page>