<apex:page standardStylesheets="false" showHeader="false" controller="BMCServiceDesk.AdminSelfServiceController" action="{!AdminSSIncidentInit}">
  <link rel="stylesheet" type="text/css" href="{!$Resource.ExtJS4_1_3}/resources/css/ext-all.css" id="ext-all-css"/> 
  <link rel="stylesheet" type="text/css" href="{!$Resource.SDEFStyles}/AdminSSIncident.css" id="incidentCSS"/>
  <link rel="Stylesheet" type="text/css" href="{!$Resource.SDEFStyles}/HelpStyles.css" />
  <style>    
    .x-window-header-text {
        font-size: 12px;
    }
    </style>  
  <apex:form id="form">
  

  
    <div id="toolbar"></div>
    <div id="helpDiv" class="clshelpDiv"></div>
    <apex:outputPanel id="mainOutputPanel"  styleClass="ClsContainer">
    <div class="clsMainContainer">
      
         <table>
                                        <tr>
                                            <td>
                                                <table>
                                                    <tr>
                                                        <td lass="clsInputLabelTD">
                                                          <apex:outputLabel value="{!$Label.BMCServiceDesk__IncidentAssignment}" /><span class="clsRequiredBlack">&nbsp;*</span>
                                                        </td>
                                                        <td  class="clsInputTextBoxTD">
                                                          <apex:inputText id="assignValue"  value="{! selfServiceBean.Assigned_Queue_to_Incident}" title="{!$Label.BMCServiceDesk__IncidentDropButton}"  styleClass="clsInputTextBoxReadOnly" onmouseover="setReadOnly();"  style="background-color:white;"/>
                                                        </td>
                                                        <td class="lookupIconTD">
                                                          <div class="lookUpIconDiv">
                                                              <apex:commandButton onclick="openQueueOnlyPopUp();"  reRender="dummy" styleClass="lookupIconOn" />
                                                                <script>
                                                                  function openQueueOnlyPopUp(){
                                                                    openPopup('SearchPage?popupId=Queue&isQueurorUser=true&isLookup=true&queueFor=Incident__c&isOnlyQueueList=true&filterClause='+escape("sobjectType='" + objName +"'"), openQueuePopup, 580,475); 
                                                                  }
                                                                </script> 
                                                            </div>  
                                                         </td>
                                                     </tr>
                                                   </table>
                                              </td>
                                        </tr>
                                        <tr>
                                            <td><div class="div9pxVspacing"/></td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <table  >
                                                    <tr>
                                                        <td class="clsInputCheckBox">
                                                                <apex:inputCheckbox id="closeIncident" value="{!selfServiceBean.Allow_to_Close_Incident}" onClick="enableRadio();" />
                                                        </td>
                                                        <td>
                                                                <apex:outputLabel value="{!$Label.BMCServiceDesk__AllowUserToCloseIncident}" styleClass="clsInputCheckBoxLabel"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                      <td class="clsTRHeight"></td><td></td></tr>
                                                    <tr>
                                                    
                                                         <td style="padding-left:10px;">
                                                           </td><td>
                                                              <input type="radio" class="checkLabelST" id="required" name="resolution" value="required">{!JSENCODE($Label.IncidentResolutionRequired)}</input><br/>
                                                              <div class="clsRadioSeprator"></div>
                                  <input type="radio" class="checkLabelST" id="notRequired" name="resolution" value="notrequired">{!JSENCODE($Label.IncidentResolutionNotRequired)}</input>
                                                           </td>
                                                    
                                                    </tr>
                                                    <tr>
                                                      <td class="clsTRHeight"></td><td></td>
                                                    </tr>
                                                    <apex:outputPanel rendered="{!isSSSwitchNewUI}" layout="none">       
                                                    <tr>
                                                        <td class="clsInputCheckBox">
                                                            <apex:inputCheckbox id="copyIncident" value="{!selfServiceBean.Allow_to_Copy_Incident}"/>
                                                        </td>
                                                        <td>
                                                            <apex:outputLabel value="{!$Label.BMCServiceDesk__AllowClientsToCopyIncidents}" styleClass="clsInputCheckBoxLabel"/>
                                                        </td>
                                                    </tr>
                                                <tr>
                                                      <td class="clsTRHeight"></td><td></td>
                                                    </tr>
                                                    </apex:outputPanel> 
                                                    <tr>
                                                        <td class="clsInputCheckBox">
                                                            <apex:inputCheckbox id="reopenIncident" value="{!selfServiceBean.Allow_to_Reopen_Incident}"/>
                                                        </td>
                                                        <td>
                                                            <apex:outputLabel value="{!$Label.BMCServiceDesk__AllowUserToReopenIncident}" styleClass="clsInputCheckBoxLabel"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                      <td class="clsTRHeight"></td><td></td>
                                                    </tr>
                                                <tr> 
                                                        <td class="clsInputCheckBox">
                                                                <apex:inputCheckbox id="submitNewIncident" value="{!selfServiceBean.submit_Incident}"/> 
                                                                </td><td>
                                                                <apex:outputLabel value="{!IF(isSSSwitchNewUI,$Label.BMCServiceDesk__ShowSubmitATicketLink,$Label.BMCServiceDesk__ShowNewServiceRequestButton)}" styleClass="clsInputCheckBoxLabel"/>
                                                        </td>
                                                    </tr>
                           <tr>
                                                        <td class="clsTRHeight"></td><td></td>
                                                    </tr>
                                                    <apex:outputPanel rendered="{!isSSSwitchNewUI}" layout="none">
                                                    <tr> 
                                                        <td class="clsInputCheckBox">
                                                                <apex:inputCheckbox id="createInc" value="{!selfServiceBean.CreateIncForBroadcast}"/>
                                                        </td>
                                                        <td>
                                                                <apex:outputLabel value="{!$Label.BMCServiceDesk__AllowToSubmitIncidentFromBroadcast}"  styleClass="clsInputCheckBoxLabel"/>
                                                        </td>
                                                     </tr>
                          <tr>
                            <td class="clsTRHeight"></td><td></td>
                          </tr>
                          </apex:outputPanel>
                                                    <tr> 
                                                      <td class="clsInputCheckBox">
                                                                <apex:inputCheckbox id="showNoteField" value="{!selfServiceBean.Show_Note_field}"/>
                                                        </td>
                                                        <td>
                                                                <apex:outputLabel value="{!$Label.BMCServiceDesk__AllowUserToAddNotesToTheirIncidents}" styleClass="clsInputCheckBoxLabel"/>
                                                        </td>
                                                     </tr>
                                                     <tr>
                                                      <td class="clsTRHeight"></td><td></td>
                                                     </tr>
                                                </table>
                                            </td>    
                                        </tr>
                                         <tr>
                      <td>
                                               <table >
                                                    <tr> 
                                                        <td class="clsInputCheckBox" >
                                                            
                                                            <apex:inputCheckbox id="limitClosedIncidents" value="{!selfServiceBean.Limit_Closed_Incidents}" onClick="enableCloseIncidentDays()"/>
                                                            </td><td>
                                                            <apex:outputLabel value="{!$Label.BMCServiceDesk__IncidentHistory}" styleClass="clsInputCheckBoxLabel"/>
                                                        </td>                                                            
                                                        <td class="clsInputCheckBox"  >
                                                            <apex:inputText id="selectDays" maxlength="9"  styleClass=" clsSelectDays" value="{!days}"/>
                                                        </td>
                                                        
                                                        <td class="clsInputCheckBox">
                                                          <apex:outputLabel styleClass="clsInputCheckBoxLabel" style="padding-top:1px;" value="{!$Label.BMCServiceDesk__IncidentHistoryDays}"/>
                                                        </td>
                                                   </tr>
                                                  </table> 
                                              </td>
                                          </tr>
                                          <tr>
                                                <td class="clsTRHeight"></td><td></td>
                                          </tr>
                                           <tr>
                                           <td>
                                            <apex:outputLabel value="{!$Label.BMCServiceDesk__EnableFilterByState}" /> 
                                            <apex:selectRadio value="{!selfServiceBean.Enablefilter}" layout="pageDirection" styleClass="radioCls">                                 
                                            <apex:selectOption itemValue="STATE" itemlabel="{!JSENCODE($Label.BMCServiceDesk__State)}" />
                      <apex:selectOption itemValue="STATUS" itemlabel="{!JSENCODE($Label.BMCServiceDesk__Status)}"/>    
                                            <apex:selectOption itemValue="BOTH" itemlabel="{!JSENCODE($Label.BMCServiceDesk__StateAndStatus)}" /> 
                                            </apex:selectRadio>
                                            </td>
                                          </tr>
                                    </table>
        </div>
     </apex:outputPanel>

  <apex:actionFunction name="save" action="{!saveIncident}"  rerender="" onComplete="showMessage('{!JSINHTMLENCODE(messageString)}');" >
      <apex:param assignTo="{!selfServiceBean.Allow_incident_resolution}" name="isRequired" value=""/>
  </apex:actionFunction>
  <apex:actionFunction name="resetHandler" action="{!AdminSSIncidentInit}"  rerender="mainOutputPanel" onComplete="OnloadJavascript('{!selfServiceBean.Allow_Incident_Resolution}')" />
  <apex:actionFunction name="assignIncidentTOQueue" action="{!assignIncidentTOQueue}"  rerender="assignValue" > 
                     <apex:param assignTo="{!savedID}" name="savedName" value=""/>
                     
    </apex:actionFunction>
      
    
    
              <script>
                var assignValuevar      = '{!JSENCODE($Component.form.assignValue)}';
        var closeIncidentvar    = '{!JSENCODE($Component.form.closeIncident)}';
        var selectDaysvariable    = '{!JSENCODE($Component.form.selectDays)}';
        var selectDaysvariable    = '{!JSENCODE($Component.form.selectDays)}';
        var limitClosedIncidentsvar = '{!JSENCODE($Component.form.limitClosedIncidents)}';
        var objName         = '{!JSENCODE(objName)}';  
        var savelabel         = '{!JSENCODE($Label.Save)}';
        var SelectIncidentQueue   = '{!JSENCODE($Label.SelectIncidentAssignment)}';
        var InvalidDaysMsg      = '{!JSENCODE($label.InvalidDaysMsg)}';
          var resolutionvalue     = '{!SelfServiceSetting.Allow_incident_resolution__c}';  
        var refreshLabel      = '{!JSENCODE($Label.Refresh)}'; 
        var messagetitle            = '{!JSENCODE($Label.Navigator_Incidents)}';
        
        OnloadJavascript(resolutionvalue);
        var wikiUrl='{!wikiUrl}';
                parent.addHelpOnPage(document.getElementById('helpDiv'),'incidents_SS_settings.htm',wikiUrl);
              </script>
</apex:form> 
<apex:includeScript value="{!$Resource.BMCServiceDesk__ExtJS4_1_3}/ext-all.js" id="ext-all-js"/>
<apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFCommonJS}/JSCommon.js" id="JSCommon-js"/>
<apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFCommonJS}/AdminSSIncident.js" id="incident-js"/>
<apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFCommonJS}/WikiHelp.js"/>
  
</apex:page>